import discord
from discord.ext import commands
import json
import os

bot = commands.Bot(command_prefix="!", intents=discord.Intents.all())

# Dictionnaire des points par utilisateur
points = {}

# --- Chargement des points au dÃ©marrage ---
def load_points():
    global points
    if os.path.exists("points.json"):
        with open("points.json", "r") as f:
            points = json.load(f)
    else:
        points = {}

# --- Sauvegarde des points ---
def save_points():
    with open("points.json", "w") as f:
        json.dump(points, f, indent=4)

# --- Quand le bot est prÃªt ---
@bot.event
async def on_ready():
    load_points()
    print(f"{bot.user} est connectÃ© ! Points chargÃ©s : {len(points)} utilisateurs")

# --- Exemple : systÃ¨me de points par rÃ©action ---
@bot.event
async def on_reaction_add(reaction, user):
    if user.bot:
        return

    emoji = str(reaction.emoji)

    # Valeurs selon lâ€™emoji (tu peux adapter)
    valeurs = {
        "ğŸƒ": 31,
        "ğŸ‘»": 4,
        "ğŸ§Ÿ": 7,
        "ğŸ¬": 50,
        "ğŸ”ª": 12,
        "ğŸ’€": 10,
        "ğŸº": 17,
    }

    if emoji in valeurs:
        user_id = str(user.id)
        points[user_id] = points.get(user_id, 0) + valeurs[emoji]
        save_points()  # Sauvegarde aprÃ¨s chaque ajout
        print(f"{user} a gagnÃ© {valeurs[emoji]} points (total: {points[user_id]})")

# --- Commande pour voir ses points ---
@bot.command()
async def points_moi(ctx):
    user_id = str(ctx.author.id)
    user_points = points.get(user_id, 0)
    await ctx.send(f"ğŸƒ {ctx.author.mention}, tu as **{user_points} points** !")

bot.run("DISCORD_TOKEN")
